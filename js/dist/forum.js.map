{"version":3,"sources":["webpack://@the-turk/flarum-diff/webpack/bootstrap","webpack://@the-turk/flarum-diff/./forum.js","webpack://@the-turk/flarum-diff/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://@the-turk/flarum-diff/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@the-turk/flarum-diff/./src/forum/components/DiffButton.js","webpack://@the-turk/flarum-diff/./src/forum/components/DiffDropdown.js","webpack://@the-turk/flarum-diff/./src/forum/components/DiffList.js","webpack://@the-turk/flarum-diff/./src/forum/components/DiffModal.js","webpack://@the-turk/flarum-diff/./src/forum/index.js","webpack://@the-turk/flarum-diff/./src/forum/models/Diff.js","webpack://@the-turk/flarum-diff/external \"flarum.core.compat['Component']\"","webpack://@the-turk/flarum-diff/external \"flarum.core.compat['Model']\"","webpack://@the-turk/flarum-diff/external \"flarum.core.compat['app']\"","webpack://@the-turk/flarum-diff/external \"flarum.core.compat['components/Alert']\"","webpack://@the-turk/flarum-diff/external \"flarum.core.compat['components/Button']\"","webpack://@the-turk/flarum-diff/external \"flarum.core.compat['components/CommentPost']\"","webpack://@the-turk/flarum-diff/external \"flarum.core.compat['components/DiscussionPage']\"","webpack://@the-turk/flarum-diff/external \"flarum.core.compat['components/Dropdown']\"","webpack://@the-turk/flarum-diff/external \"flarum.core.compat['components/LoadingIndicator']\"","webpack://@the-turk/flarum-diff/external \"flarum.core.compat['components/Modal']\"","webpack://@the-turk/flarum-diff/external \"flarum.core.compat['extend']\"","webpack://@the-turk/flarum-diff/external \"flarum.core.compat['helpers/avatar']\"","webpack://@the-turk/flarum-diff/external \"flarum.core.compat['helpers/humanTime']\"","webpack://@the-turk/flarum-diff/external \"flarum.core.compat['helpers/icon']\"","webpack://@the-turk/flarum-diff/external \"flarum.core.compat['helpers/username']\"","webpack://@the-turk/flarum-diff/external \"flarum.core.compat['models/Post']\"","webpack://@the-turk/flarum-diff/external \"flarum.core.compat['utils/extractText']\"","webpack://@the-turk/flarum-diff/external \"flarum.core.compat['utils/mixin']\""],"names":["DiffButton","view","attrs","props","item","subButton","type","getButtonContent","diff","actor","editedInfo","extractText","app","translator","trans","username","ago","humanTime","createdAt","deletedAt","deletedUser","avatar","icon","className","Button","DiffDropdown","initProps","buttonClassName","menuClassName","label","init","post","list","DiffList","getButton","vdom","title","onclick","bind","getMenu","showing","render","load","Dropdown","loading","cache","diffs","pages","id","postRevisionCount","revisionCount","transChoice","length","map","items","forEach","push","diffButton","component","modal","show","DiffModal","toggleSubDiff","LoadingIndicator","m","redraw","postRedrawer","postId","store","find","then","parseResults","results","save","$subDiff","$","$parentDiff","$icon","toggle","hasClass","removeClass","addClass","Component","attributes","data","route","user","config","isInitialized","forum","attribute","setModalContent","canDeleteEditHistory","confirm","toggleDeleteButton","close","showDeletionAlert","hide","content","message","success","error","alerts","Alert","children","state","$deleteButton","prop","renderHtml","trust","htmlContent","$modalContent","sideBySideHtml","html","syncScroll","changeModalSize","inlineHtml","$modal","element","includes","replace","$el1","$el2","forcedScroll","scroll","performScroll","$scrolled","$toScroll","percent","scrollLeft","scrollWidth","offsetWidth","setScrollTopFromPercent","$el","scrollTopPos","Modal","initializers","add","models","Diff","Post","prototype","Model","canViewEditHistory","extend","CommentPost","isEdited","isHidden","isEditing","DiscussionPage","$exists","on","e","stopPropagation","mixin","revision","transformDate","hasOne"],"mappings":"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","file":"forum.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./forum.js\");\n","export * from './src/forum';","export default function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}","export default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}","import Button from 'flarum/components/Button';\nimport avatar from 'flarum/helpers/avatar';\nimport icon from 'flarum/helpers/icon';\nimport username from 'flarum/helpers/username';\nimport humanTime from 'flarum/helpers/humanTime';\nimport extractText from 'flarum/utils/extractText';\n\nexport default class DiffButton extends Button {\n    view()\n    {\n        const attrs = Object.assign({}, this.props);\n\n        delete attrs.item;\n        delete attrs.subButton;\n\n        attrs.type = 'button';\n\n        return <button {...attrs}>{this.getButtonContent()}</button>;\n    }\n\n  /**\n   * Get the template for the button's content.\n   *\n   * @return {*}\n   * @protected\n   */\n    getButtonContent()\n    {\n        const diff = this.props.item;\n\n        let actor = diff.actor();\n        let editedInfo = extractText(app.translator.trans(\n            'core.forum.post.edited_tooltip',\n            {username: username(diff.actor()), ago: humanTime(diff.createdAt())}\n        ));\n\n        if (diff.deletedAt()) {\n            if (this.props.subButton === false) {\n                editedInfo = editedInfo + ' ' + app.translator.trans('the-turk-diff.forum.deletedText');\n            } else {\n                actor = diff.deletedUser();\n                editedInfo = extractText(app.translator.trans(\n                    'the-turk-diff.forum.deletedTooltip',\n                    {username: username(diff.deletedUser()), ago: humanTime(diff.deletedAt())}\n                ));\n            }\n        }\n\n        return [\n            actor.username() ? avatar(actor) : '',\n            diff.deletedAt() && this.props.subButton === false ?\n              icon('fas fa-caret-down', {className: 'Button-caret'}) : '',\n            <span className=\"Button-label\" title={editedInfo}>\n              {diff.deletedAt() && this.props.subButton === true ?\n                    <em>\n                    {editedInfo}\n                    </em> : editedInfo}\n            </span>\n        ];\n    }\n}\n","import Dropdown from 'flarum/components/Dropdown';\nimport DiffList from './DiffList';\nimport icon from 'flarum/helpers/icon';\n\nexport default class DiffDropdown extends Dropdown {\n      static initProps(props)\n      {\n        props.className = 'DiffDropdown';\n        props.buttonClassName = 'Button Button--link';\n        props.menuClassName = props.menuClassName;\n        props.label = app.translator.trans('core.forum.post.edited_text');\n        props.icon = 'fas fa-history';\n\n        super.initProps(props);\n      }\n\n      init()\n      {\n          super.init();\n          const post = this.props.post;\n          this.list = new DiffList({post});\n      }\n\n      getButton()\n      {\n          const vdom = super.getButton();\n\n          vdom.attrs.title = this.props.label;\n          vdom.attrs.onclick = this.onclick.bind(this);\n\n          return vdom;\n      }\n\n      getButtonContent()\n      {\n          return [\n            icon(this.props.icon, {className: 'Button-icon'}),\n            <span className=\"Button-label\">{this.props.label}</span>\n          ];\n      }\n\n      getMenu()\n      {\n          return (\n            <div className={'Dropdown-menu ' + this.props.menuClassName}>\n              {this.showing ? this.list.render() : ''}\n            </div>\n          );\n      }\n\n      onclick()\n      {\n          this.list.load();\n      }\n}\n","import app from 'flarum/app';\nimport Component from 'flarum/Component';\nimport DiffButton from './DiffButton';\nimport DiffModal from './DiffModal';\nimport LoadingIndicator from 'flarum/components/LoadingIndicator';\n\n/**\n * The `DiffList` component displays a list of the post's diffs.\n */\nexport default class DiffList extends Component {\n    init()\n    {\n        /**\n         * Whether or not the diffs are loading.\n         *\n         * @type {Boolean}\n         */\n        this.loading = false;\n\n        if (!app.cache.diffs) {\n            /**\n             * Initialize the cache.\n             *\n             * @type {Array}\n             */\n            app.cache.diffs = [];\n        }\n    }\n\n    view()\n    {\n        const post = this.props.post;\n        const pages = app.cache.diffs[post.id()] || [];\n        const postRevisionCount = post.revisionCount();\n\n        return (\n          <div className=\"DiffList\">\n            <div className=\"DiffList-header\">\n              <h4>\n                {app.translator.transChoice('the-turk-diff.forum.revisionInfo', postRevisionCount, {\n                    revisionCount: postRevisionCount\n                })}\n              </h4>\n            </div>\n\n            <div className=\"DiffList-content\">\n              <ul>\n                {pages.length ? pages.map(diffs => {\n                    const items = [];\n\n                    diffs.forEach(diff => {\n                        items.push(diff);\n                    });\n\n                  return items.map(item => {\n                        let diffButton = DiffButton.component({\n                            subButton: false,\n                            item,\n                            onclick: () => {\n                                if (!item.deletedAt()) {\n                                    app.modal.show(new DiffModal({item, post}));\n                                } else {\n                                    this.toggleSubDiff(item.id());\n                                }\n                            }\n                        });\n                    return (\n                      <div className=\"DiffList-holder\">\n                        <li className={'Diff ParentDiff' + (item.deletedAt() ? ' has-sub' : '')} id={'parentDiff' + item.id()}>\n                          {diffButton}\n                        </li>\n                        {item.deletedAt() ?\n                            <li className=\"Diff SubDiff\" id={'subDiff' + item.id()} style=\"display:none;\">\n                                {DiffButton.component({item, subButton: true})}\n                            </li>\n                            : ''}\n                      </div>\n                    );\n                    });\n                }) : ''}\n\n                {\n                    this.loading ?\n                    LoadingIndicator.component({\n                        className: 'LoadingIndicator--block'\n                    })\n                  : (pages.length ? '' :\n                      <div className=\"DiffList-empty\">\n                        {app.translator.trans('the-turk-diff.forum.emptyText')}\n                      </div>\n                    )\n                }\n              </ul>\n            </div>\n          </div>\n        );\n    }\n\n    /**\n     * Load diff results.\n     *\n     * @public\n     */\n    load()\n    {\n        if (app.cache.diffs[this.props.post.id()]) {\n            m.redraw();\n            // also redraw the post because it sometimes\n            // appears and sometimes doesn't after editing a post\n            return this.postRedrawer();\n        }\n\n        this.loading = true;\n        m.redraw(); // redraw for this view()\n        this.postRedrawer();\n\n        const postId = this.props.post.id();\n\n        return app.store.find('diff', postId)\n          .then(this.parseResults.bind(this))\n          .catch(() => {})\n          .then(() => {\n                this.loading = false;\n                m.redraw(); // redraw for this view()\n                this.postRedrawer();\n            });\n    }\n\n    /**\n     * Parse results and append them to the diff list.\n     *\n     * @param {Diff[]} results\n     * @return {Diff[]}\n     */\n    parseResults(results)\n    {\n        app.cache.diffs[this.props.post.id()] = app.cache.diffs[this.props.post.id()] || [];\n\n        if (results.length) {\n            app.cache.diffs[this.props.post.id()].push(results);\n        }\n\n        return results;\n    }\n\n    /**\n     * Redraw the post.\n     * Workaround for:\n     * https://discuss.flarum.org/d/22755-mithril-related-issues-on-poststream-items\n     */\n    postRedrawer()\n    {\n        return this.props.post.save({}).then(\n            () => m.redraw()\n        );\n    }\n\n    /**\n     * @param id\n     */\n    toggleSubDiff(id)\n    {\n        const $subDiff = this.$('.DiffList-holder #subDiff'+id);\n        const $parentDiff = this.$('.DiffList-holder #parentDiff'+id);\n        const $icon = $parentDiff.find('.icon');\n\n        $subDiff.toggle();\n\n        if ($icon.hasClass('fa-caret-down')) {\n            $icon.removeClass('fa-caret-down').addClass('fa-caret-up');\n        } else {\n            $icon.removeClass('fa-caret-up').addClass('fa-caret-down');\n        }\n    }\n}\n","import app from 'flarum/app';\nimport Modal from 'flarum/components/Modal';\nimport Button from 'flarum/components/Button';\nimport username from 'flarum/helpers/username';\nimport humanTime from 'flarum/helpers/humanTime';\nimport avatar from 'flarum/helpers/avatar';\nimport Alert from 'flarum/components/Alert';\nimport LoadingIndicator from 'flarum/components/LoadingIndicator';\n\nexport default class DiffModal extends Modal {\n    init()\n    {\n        super.init();\n\n        /**\n         * Whether or not the component is loading.\n         *\n         * @type {Boolean}\n         */\n        this.loading = false;\n\n        this.attributes = this.props.item.data.attributes;\n    }\n\n    className()\n    {\n        return 'DiffModal';\n    }\n\n    title()\n    {\n        return [\n          this.props.item.actor().username() ? avatar(this.props.item.actor()) : '',\n          app.translator.trans('core.forum.post.edited_tooltip', {\n                username:\n                  <a href={app.route.user(this.props.item.actor())} config={m.route}>\n                    {username(this.props.item.actor())}\n                  </a>,\n                ago: humanTime(this.props.item.createdAt())\n            })\n        ];\n    }\n\n    config(isInitialized) {\n        if (isInitialized) return;\n\n        if (app.forum.attribute('diffRenderer') === 'Inline') {\n            this.setModalContent('inline');\n        } else {\n            this.setModalContent('sideBySide');\n        }\n    }\n\n    view()\n    {\n        return (\n          <div className={'Modal modal-dialog ' + this.className()}>\n            <div className=\"Modal-content\">\n                <div className=\"Modal-close App-backControl\">\n                  {(this.attributes.canDeleteEditHistory ?\n                        Button.component({\n                            icon: 'fas fa-trash-alt',\n                            onclick: () => {\n                                if (confirm(app.translator.trans('the-turk-diff.forum.confirmDelete'))) {\n                                    this.toggleDeleteButton('disable');\n                                    this.loading = true;\n                                    m.redraw();\n\n                                    this.props.item.delete().then(() => {\n                                        app.modal.close();\n                                        if (app.cache.diffs && app.cache.diffs[this.props.post.id()]) {\n                                            delete app.cache.diffs[this.props.post.id()];\n                                        }\n                                        this.showDeletionAlert('success');\n                                    }).catch(() => {\n                                        this.toggleDeleteButton('enable');\n                                        this.loading = false;\n                                        m.redraw();\n\n                                        this.showDeletionAlert('error');\n                                    });\n                                }\n                            },\n                            className: 'Button DeleteButton Button--icon Button--link'\n                        }) : ''\n                  )}\n\n                  {Button.component({\n                        icon: 'fas fa-times',\n                        onclick: this.hide.bind(this),\n                        className: 'Button Button--icon Button--link'\n                    })}\n                </div>\n\n                <div className=\"Modal-header\">\n                  <h3 className=\"App-titleControl App-titleControl--text\">{this.title()}</h3>\n                </div>\n\n                {this.content()}\n            </div>\n          </div>\n        );\n    }\n\n    content()\n    {\n        return [\n          app.forum.attribute('allowDiffSwitch') ?\n            <div className=\"controlsContainer\">\n              {Button.component({\n                icon: 'fas fa-grip-lines',\n                onclick: () => {\n                  this.setModalContent('inline');\n                },\n                className: 'Button Button--icon Button--link inlineView'\n              })}\n              {Button.component({\n                icon: 'fas fa-columns',\n                onclick: () => {\n                  this.setModalContent('sideBySide');\n                },\n                className: 'Button Button--icon Button--link sideBySideView'\n              })}\n            </div> : '',\n          <div className=\"Modal-body\">\n            <div className=\"diffContainer\"></div>\n            {LoadingIndicator.component({className: 'DiffModal-loading' + (this.loading ? ' active' : '')})}\n          </div>\n        ];\n    }\n\n    /**\n     * Show deletion alert of diff.\n     *\n     * @param {string} type\n     */\n    showDeletionAlert(type)\n    {\n        const message = {\n            success: 'the-turk-diff.forum.deleteSuccessMessage',\n            error: 'the-turk-diff.forum.deleteErrorMessage',\n        }[type];\n\n        app.alerts.show(new Alert({\n            type,\n            children: app.translator.trans(message)\n        }));\n    }\n\n    toggleDeleteButton(state)\n    {\n        const $deleteButton = this.$('.DeleteButton');\n\n        if (state === 'disable') {\n            $deleteButton.prop('disabled', true);\n        } else if (state === 'enable') {\n            $deleteButton.prop('disabled', false);\n        }\n    }\n\n    renderHtml(content)\n    {\n        // do we need to worry about m.trust() function?\n        // well, Flarum itself doing the same way for rendering\n        // post items as seen on:\n        // https://github.com/flarum/core/blob/afe06ea750cfd81767461a3884a92a26f0b0ce37/js/src/forum/components/CommentPost.js#L52\n        // also, the diff library itself treat all inputs as plain text\n        // just before creating JSON data:\n        // https://github.com/jfcherng/php-diff/issues/9#issuecomment-526808774\n        // so no need to use additional Sanitizer lib for this operation.\n\n        return m.trust(content);\n    }\n\n    setModalContent(content)\n    {\n        let htmlContent;\n        const $modalContent = this.$('.diffContainer');\n\n        if (content === 'sideBySide') {\n            htmlContent = this.renderHtml(this.attributes.sideBySideHtml);\n            $modalContent.html(htmlContent);\n            if(app.forum.attribute('enableDiffSyncScroll')) {\n              this.syncScroll();\n            }\n            this.changeModalSize('large');\n            this.$('.Button.sideBySideView').prop('disabled', true);\n            this.$('.Button.inlineView').prop('disabled', false);\n        } else if (content === 'inline') {\n            htmlContent = this.renderHtml(this.attributes.inlineHtml);\n            $modalContent.html(htmlContent);\n            this.changeModalSize();\n            this.$('.Button.sideBySideView').prop('disabled', false);\n            this.$('.Button.inlineView').prop('disabled', true);\n        }\n    }\n\n    changeModalSize(type = '')\n    {\n        const $modal = this.element;\n        const className = $modal.className;\n\n        if (type === 'large' && !className.includes('Modal--' + type))\n        {\n            $modal.className += ' Modal--large';\n        } else if (className.includes('Modal--large')) {\n            $modal.className = className.replace(' Modal--large', '');\n        }\n    }\n\n    /**\n     * Synchronize Scroll\n     * implemented from:\n     * https://stackoverflow.com/a/27007581\n     * Should be working with Zepto.js\n     */\n    syncScroll()\n    {\n        const $el1 = this.$('.diff-side-item.left-item');\n        const $el2 = this.$('.diff-side-item.right-item');\n\n        // Lets us know when a scroll is organic\n        // or forced from the synced element.\n        let forcedScroll = false;\n\n        // Catch our elements' scroll events and\n        // syncronize the related element.\n        $el1.scroll(function() { performScroll($el1, $el2); });\n        $el2.scroll(function() { performScroll($el2, $el1); });\n\n        // Perform the scroll of the synced element\n        // based on the scrolled element.\n        function performScroll($scrolled, $toScroll) {\n            if (forcedScroll) return (forcedScroll = false);\n            const percent = ($scrolled.scrollLeft() /\n              ($scrolled[0].scrollWidth - $scrolled[0].offsetWidth)) * 100;\n            setScrollTopFromPercent($toScroll, percent);\n        }\n\n        // Scroll to a position in the given\n        // element based on a percent.\n        function setScrollTopFromPercent($el, percent) {\n            const scrollTopPos = (percent / 100) *\n              ($el[0].scrollWidth - $el[0].offsetWidth);\n            forcedScroll = true;\n            $el.scrollLeft(scrollTopPos);\n        }\n    }\n}\n","import app from 'flarum/app';\nimport {extend} from 'flarum/extend';\nimport CommentPost from 'flarum/components/CommentPost';\nimport Diff from './models/Diff';\nimport Post from 'flarum/models/Post';\nimport Model from 'flarum/Model';\nimport DiffDropdown from './components/DiffDropdown';\nimport DiscussionPage from 'flarum/components/DiscussionPage';\n\napp.initializers.add('the-turk/diff', () => {\n    app.store.models.diff = Diff;\n    Post.prototype.revisionCount = Model.attribute('revisionCount');\n    Post.prototype.canViewEditHistory = Model.attribute('canViewEditHistory');\n\n    extend(CommentPost.prototype, 'headerItems', function (items) {\n        const post = this.props.post;\n\n        // replace \"edited\" text to \"edited\" button\n        if (post.isEdited() && !post.isHidden()\n              && post.canViewEditHistory() && post.revisionCount() > 0) {\n            items.replace('edited', DiffDropdown.component({post}));\n        }\n\n        // remove diffs cache when post is editing\n        if (this.isEditing() && app.cache.diffs\n              && app.cache.diffs[this.props.post.id()]) {\n            delete app.cache.diffs[this.props.post.id()];\n        }\n    });\n\n    extend(DiscussionPage.prototype, 'init', function () {\n        // prevent dropdown from closing when user\n        // clicks on deleted diff\n\n        const $exists = $('body');\n\n        $exists.on('click', 'li.ParentDiff.has-sub', function (e) {\n            e.stopPropagation();\n        });\n\n        $exists.on('click', 'li.SubDiff', function (e) {\n            e.stopPropagation();\n        });\n    });\n});\n","import Model from 'flarum/Model';\nimport mixin from 'flarum/utils/mixin';\n\nexport default class Diff extends mixin(Model, {\n    revision: Model.attribute('revision'),\n    createdAt: Model.attribute('createdAt', Model.transformDate),\n    deletedAt: Model.attribute('deletedAt', Model.transformDate),\n    actor: Model.hasOne('actor'),\n    deletedUser: Model.hasOne('deletedUser'),\n    inlineHtml: Model.attribute('inlineHtml'),\n    sideBySideHtml: Model.attribute('sideBySideHtml'),\n    canDeleteEditHistory: Model.attribute('canDeleteEditHistory')\n}) {}\n","module.exports = flarum.core.compat['Component'];","module.exports = flarum.core.compat['Model'];","module.exports = flarum.core.compat['app'];","module.exports = flarum.core.compat['components/Alert'];","module.exports = flarum.core.compat['components/Button'];","module.exports = flarum.core.compat['components/CommentPost'];","module.exports = flarum.core.compat['components/DiscussionPage'];","module.exports = flarum.core.compat['components/Dropdown'];","module.exports = flarum.core.compat['components/LoadingIndicator'];","module.exports = flarum.core.compat['components/Modal'];","module.exports = flarum.core.compat['extend'];","module.exports = flarum.core.compat['helpers/avatar'];","module.exports = flarum.core.compat['helpers/humanTime'];","module.exports = flarum.core.compat['helpers/icon'];","module.exports = flarum.core.compat['helpers/username'];","module.exports = flarum.core.compat['models/Post'];","module.exports = flarum.core.compat['utils/extractText'];","module.exports = flarum.core.compat['utils/mixin'];"],"sourceRoot":""}